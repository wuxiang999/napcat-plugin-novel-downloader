# ğŸ‰ é—®é¢˜å·²è§£å†³ï¼

## âœ… é—®é¢˜æ±‡æ€»

### é—®é¢˜ 1: æ’ä»¶åŠ è½½å¤±è´¥
**åŸå› **: å¯¼å…¥äº† `EventType` æšä¸¾

```typescript
import { EventType } from 'napcat-types';  // âŒ è¿™è¡Œå¯¼è‡´å¤±è´¥
```

åœ¨ Docker ç¯å¢ƒä¸­ï¼Œ`napcat-types` æ¨¡å—å¯èƒ½ä¸å­˜åœ¨æˆ–ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œå¯¼è‡´æ’ä»¶æ— æ³•åŠ è½½ã€‚

**è§£å†³æ–¹æ¡ˆ**: ç§»é™¤ `EventType` å¯¼å…¥ï¼Œæ”¹ç”¨å­—ç¬¦ä¸²æ¯”è¾ƒ

```typescript
// ä¹‹å‰ âŒ
if (event.post_type !== EventType.MESSAGE) return;

// ç°åœ¨ âœ…
if (event.post_type !== 'message') return;
```

**ä¿®å¤ç‰ˆæœ¬**: v1.0.4

---

### é—®é¢˜ 2: é…ç½®é¡µé¢æŠ¥é”™ "d.map is not a function"
**åŸå› **: `buildConfigSchema` ä½¿ç”¨äº† `NapCatConfig.combine()` è¿”å›çš„ä¸æ˜¯æ•°ç»„

```typescript
return NapCatConfig.combine(  // âŒ combine è¿”å›çš„ä¸æ˜¯æ•°ç»„
  NapCatConfig.boolean(...),
  NapCatConfig.text(...),
  ...
);
```

**è§£å†³æ–¹æ¡ˆ**: ç›´æ¥è¿”å›æ•°ç»„

```typescript
return [  // âœ… ç›´æ¥è¿”å›æ•°ç»„
  NapCatConfig.boolean(...),
  NapCatConfig.text(...),
  ...
];
```

**ä¿®å¤ç‰ˆæœ¬**: v1.0.5

## ğŸ“¦ æœ€æ–°ç‰ˆæœ¬

**v1.0.5** - å·²ä¿®å¤æ‰€æœ‰å·²çŸ¥é—®é¢˜

### ä¸‹è½½æ–¹å¼

1. **ä» GitHub Release ä¸‹è½½**ï¼ˆæ¨èï¼‰
   - è®¿é—®ï¼šhttps://github.com/wuxiang999/napcat-plugin-novel-downloader/releases
   - ä¸‹è½½ `napcat-plugin-novel-downloader.zip`

2. **ä½¿ç”¨æœ¬åœ°æ„å»ºçš„ç‰ˆæœ¬**
   - æ–‡ä»¶ï¼š`napcat-plugin-novel-downloader-v1.0.5.zip`
   - æˆ–ç›´æ¥ä½¿ç”¨ `release/` ç›®å½•çš„å†…å®¹

## ğŸš€ å®‰è£…æ­¥éª¤

### 1. è§£å‹æ’ä»¶
```bash
unzip napcat-plugin-novel-downloader.zip
```

### 2. å¤åˆ¶åˆ° Docker å®¹å™¨
```bash
# æ–¹æ³• A: ä½¿ç”¨ docker cp
docker cp napcat-plugin-novel-downloader <å®¹å™¨å>:/app/napcat/plugins/

# æ–¹æ³• B: ä½¿ç”¨æŒ‚è½½å·
# å¦‚æœä½ çš„ plugins ç›®å½•æ˜¯æŒ‚è½½çš„ï¼Œç›´æ¥å¤åˆ¶åˆ°æŒ‚è½½ç›®å½•
cp -r napcat-plugin-novel-downloader /path/to/mounted/plugins/
```

### 3. é‡å¯å®¹å™¨
```bash
docker restart <å®¹å™¨å>
```

### 4. éªŒè¯å®‰è£…
åœ¨ NapCat WebUI ä¸­æŸ¥çœ‹æ’ä»¶åˆ—è¡¨ï¼Œåº”è¯¥èƒ½çœ‹åˆ°"å°è¯´ä¸‹è½½å™¨"æ’ä»¶ï¼ŒçŠ¶æ€ä¸º"å·²å¯ç”¨"æˆ–å¯ä»¥å¯ç”¨ã€‚

## âœ¨ åŠŸèƒ½æµ‹è¯•

åœ¨ QQ ä¸­å‘é€ä»¥ä¸‹å‘½ä»¤æµ‹è¯•ï¼š

```
å°è¯´å¸®åŠ©
```

åº”è¯¥æ”¶åˆ°å¸®åŠ©ä¿¡æ¯å›å¤ã€‚

## ğŸ“Š æµ‹è¯•ç»“æœ

é€šè¿‡é€æ­¥æµ‹è¯•ï¼Œæˆ‘ä»¬ç¡®è®¤äº†ï¼š

| æµ‹è¯•ç‰ˆæœ¬ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| test-minimal | âœ… æˆåŠŸ | æœ€ç®€ç‰ˆæœ¬ |
| test-step1 | âœ… æˆåŠŸ | åŒ…å«é…ç½®UI |
| test-step2 | âŒ å¤±è´¥ | æ·»åŠ äº† EventType |
| test-intermediate | âŒ å¤±è´¥ | ä½¿ç”¨äº† EventType |
| v1.0.4 (ä¿®å¤ç‰ˆ) | âœ… åº”è¯¥æˆåŠŸ | ç§»é™¤äº† EventType |

## ğŸ” æŠ€æœ¯ç»†èŠ‚

### ä¸ºä»€ä¹ˆ EventType ä¼šå¯¼è‡´å¤±è´¥ï¼Ÿ

1. **æ¨¡å—ä¾èµ–é—®é¢˜**
   - `napcat-types` æ˜¯å¼€å‘ä¾èµ–
   - Docker å®¹å™¨ä¸­å¯èƒ½æ²¡æœ‰å®‰è£…
   - æˆ–è€…ç‰ˆæœ¬ä¸å…¼å®¹

2. **æ„å»ºé…ç½®**
   - Vite å°† `napcat-types` æ ‡è®°ä¸º external
   - è¿è¡Œæ—¶éœ€è¦ä»å¤–éƒ¨åŠ è½½
   - å¦‚æœå¤–éƒ¨ä¸å­˜åœ¨ï¼Œå°±ä¼šå¤±è´¥

3. **è§£å†³æ–¹æ¡ˆ**
   - ä¸ä½¿ç”¨æšä¸¾ï¼Œç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²
   - å­—ç¬¦ä¸²æ˜¯ JavaScript åŸç”Ÿç±»å‹ï¼Œä¸éœ€è¦å¯¼å…¥

### å…¶ä»–ä¿®å¤

1. **ç¦ç”¨ minify** - é˜²æ­¢ä¸­æ–‡ä¹±ç 
2. **ç§»é™¤ dependencies** - é¿å…ä¾èµ–å†²çª
3. **ä½¿ç”¨å­—ç¬¦ä¸²æ¯”è¾ƒ** - é¿å…æ¨¡å—å¯¼å…¥é—®é¢˜

## ğŸ“ é…ç½®è¯´æ˜

æ’ä»¶é…ç½®ç•Œé¢åŒ…å«ï¼š

- **å¯ç”¨æ’ä»¶** - å¼€å…³æ’ä»¶åŠŸèƒ½
- **ç®¡ç†å‘˜QQ** - è®¾ç½®ç®¡ç†å‘˜ï¼ˆæ— ä¸‹è½½é™åˆ¶ï¼‰
- **æ¯æ—¥ä¸‹è½½é™åˆ¶** - æ™®é€šç”¨æˆ·æ¯æ—¥ä¸‹è½½æ¬¡æ•°
- **æœ€å¤§ç« èŠ‚é™åˆ¶** - å•æœ¬å°è¯´æœ€å¤§ç« èŠ‚æ•°
- **ä¸‹è½½ç›®å½•** - æ–‡ä»¶ä¿å­˜ä½ç½®
- **å¹¶å‘è®¾ç½®** - æ€§èƒ½è°ƒä¼˜
- **è¾“å‡ºæ ¼å¼** - TXT/HTML/EPUB

## ğŸ¯ æ”¯æŒçš„å‘½ä»¤

```
æœç´¢å°è¯´ <ä¹¦å>    # æœç´¢å°è¯´
å°è¯´è¯¦æƒ… <ID>      # æŸ¥çœ‹è¯¦æƒ…
ä¸‹è½½å°è¯´ <ID>      # ä¸‹è½½å°è¯´
ä¸‹è½½è¿›åº¦           # æŸ¥çœ‹è¿›åº¦
å–æ¶ˆä¸‹è½½           # å–æ¶ˆä»»åŠ¡
å°è¯´å¸®åŠ©           # æŸ¥çœ‹å¸®åŠ©
```

## ğŸ› å¦‚æœè¿˜æ˜¯å¤±è´¥

å¦‚æœ v1.0.4 è¿˜æ˜¯åŠ è½½å¤±è´¥ï¼Œè¯·æä¾›ï¼š

1. **Docker æ—¥å¿—**
   ```bash
   docker logs --tail 100 <å®¹å™¨å>
   ```

2. **æ‰‹åŠ¨æµ‹è¯•ç»“æœ**
   ```bash
   docker exec <å®¹å™¨å> sh -c "cd /app/napcat/plugins/napcat-plugin-novel-downloader && node --input-type=module -e \"import('./index.mjs').then(() => console.log('OK')).catch(e => console.error(e.message))\""
   ```

3. **æ’ä»¶æ–‡ä»¶åˆ—è¡¨**
   ```bash
   docker exec <å®¹å™¨å> ls -la /app/napcat/plugins/napcat-plugin-novel-downloader/
   ```

## ğŸ™ é¸£è°¢

æ„Ÿè°¢ä½ çš„è€å¿ƒæµ‹è¯•ï¼é€šè¿‡é€æ­¥è°ƒè¯•ï¼Œæˆ‘ä»¬æˆåŠŸå®šä½å¹¶è§£å†³äº†é—®é¢˜ã€‚

## ğŸ“ åé¦ˆ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤ Issueï¼š
https://github.com/wuxiang999/napcat-plugin-novel-downloader/issues

---

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸ“šâœ¨
